<nav class="navbar">
  <button class="btn back" (click)="goBack()">←</button>
  <div class="logo">
    <a href="home.component.html" style="text-decoration: none; color: #fff">
      Grocery<span>Mart</span>
    </a>
  </div>
  
  <div class="search-container">
    <input 
      type="text" 
      placeholder="Search customers..." 
      [(ngModel)]="searchQuery"
      (keypress)="onKeyPress($event)"
    />
    <button type="submit" (click)="onSearch()">
      <i class="fa fa-search" style="color: white;"></i>
    </button>
    <button 
      *ngIf="searchQuery" 
      type="button" 
      (click)="onClearSearch()" 
      style="background: none; border: none; color: white; cursor: pointer; margin-left: 5px;"
      title="Clear search"
    >
      ×
    </button>
  </div>
  
  <div class="links">
    <a routerLink="/user-dashboard/profile">Profile</a>
    <a (click)="logout()" style="cursor: pointer">Logout</a>
  </div>
</nav>

<div class="table-container">
  <h2>All Customers</h2>

  <!-- Loading state -->
  <div *ngIf="loading" class="loading-message">Loading customers...</div>

  <!-- Error state -->
  <div *ngIf="errorMsg" class="error-message">
    {{ errorMsg }}
  </div>

  <!-- No Search Results State -->
  <div *ngIf="!loading && !errorMsg && filteredCustomers.length === 0 && searchQuery" class="no-results-message">
    No customers found matching your search.
  </div>

  <!-- Customer table -->
  <table *ngIf="!loading && filteredCustomers.length > 0">
    <thead>
      <tr>
        <th>S.No</th>
        <th>Customer_ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Address</th>
        <!-- <th>Actions</th> -->
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of displayed; let i = index">
        <td>{{ (page - 1) * perPage + i + 1 }}</td>
        <td>CUST_{{ c.customerId }}</td>
        <td>{{ c.customerName }}</td>
        <td>{{ c.email }}</td>
        <td>{{ c.contactNumber }}</td>
        <td>{{ c.address }}</td>
        <!-- <td>
          <button class="btn delete" (click)="delete(c.customerId)">Delete</button>
        </td> -->
      </tr>
    </tbody>
  </table>

  <!-- Empty state -->
  <div *ngIf="!loading && filteredCustomers.length === 0 && !searchQuery" class="empty-state">
    <p>No customers found.</p>
  </div>

  <!-- Pagination -->
  <div class="pagination" *ngIf="filteredCustomers.length > 0">
    <button (click)="prev()" [disabled]="page === 1">Prev</button>
    <span>Page {{ page }}</span>
    <button (click)="next()" [disabled]="page * perPage >= filteredCustomers.length">
      Next
    </button>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal-backdrop" *ngIf="showConfirmBox">
  <div class="modal">
    <p>Are you sure you want to delete this customer?</p>
    <button class="btn update" (click)="confirmDelete()">Yes</button>
    <button class="btn delete" (click)="cancelDelete()">No</button>
  </div>
</div>

<!-- Deleted-Success Modal -->
<div class="modal-backdrop" *ngIf="showSuccessBox">
  <div class="modal">
    <p>Customer deleted successfully!</p>
    <button class="btn update" (click)="closeSuccess()">OK</button>
  </div>
</div>

<!-- Logout Confirmation Dialog -->
<app-confirmation-dialog
  [isVisible]="showLogoutConfirm"
  title="Confirm Logout"
  message="Are you sure you want to logout? You will be redirected to the home page."
  confirmText="Yes, Logout"
  cancelText="Cancel"
  (confirm)="confirmLogout()"
  (cancel)="cancelLogout()">
</app-confirmation-dialog>


