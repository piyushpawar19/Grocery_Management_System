<div class="admin-order-history">
  <nav class="navbar">
    <div class="logo">
      <a href="home.component.html" style="text-decoration:none;color: #fff;">
        Grocery<span>Mart</span>
      </a>
    </div>
    
    <div class="search-container">
      <input type="text" placeholder="Search orders..." />
      <button type="submit">
        <i class="fa fa-search" style="color: white;"></i>
      </button>
    </div>

    <div class="links">
      <a routerLink="/user-dashboard/profile">Profile</a>
      <a (click)="logout()" style="cursor: pointer;">Logout</a>
    </div>
  </nav>

  <div class="main-container">
    <aside class="sidebar">
      <button routerLink="/admin/insert-product" class="sidebar-btn">Insert Product</button>
      <button routerLink="/admin/view-product" class="sidebar-btn">View Products</button>
      <button routerLink="/admin/view-customer" class="sidebar-btn">View Customers</button>
      <button routerLink="/admin-dashboard/order-history" class="sidebar-btn active">Order History</button>
    </aside>

    <section class="dashboard-content">
      <div class="header">
        <h1>Order History</h1>
        <button (click)="loadOrders()" class="refresh-btn" [disabled]="loading">
          <i class="fa fa-refresh"></i> Refresh
        </button>
      </div>

      <div class="content">
        <!-- Loading State -->
        <div *ngIf="loading" class="loading">
          <p>Loading orders...</p>
        </div>

        <!-- Error State -->
        <div *ngIf="error" class="error">
          <p>{{ error }}</p>
          <button (click)="loadOrders()" class="retry-btn">Retry</button>
        </div>

        <!-- No Orders State -->
        <div *ngIf="!loading && !error && orders.length === 0" class="no-orders">
          <p>No orders found.</p>
        </div>

        <!-- Orders Table -->
        <div *ngIf="!loading && !error && orders.length > 0" class="orders-table-container">
          <table class="orders-table">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Customer Name</th>
                <th>Customer Email</th>
                <th>Order Date</th>
                <th>Total Amount</th>
                <th>Items</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let order of orders">
                <td>{{ order.id }}</td>
                <td>{{ order.customerName }}</td>
                <td>{{ order.customerEmail }}</td>
                <td>{{ formatDate(order.orderTime) }}</td>
                <td>{{ formatPrice(order.totalAmount) }}</td>
                <td>
                  <div class="order-items">
                    <div *ngFor="let item of order.items" class="order-item">
                      <span class="item-name">{{ item.productName }}</span>
                      <span class="item-details">
                        {{ item.quantity }} Ã— {{ formatPrice(item.price) }}
                      </span>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </div>

  <!-- Logout Confirmation Dialog -->
  <app-confirmation-dialog
    [isVisible]="showLogoutConfirm"
    title="Confirm Logout"
    message="Are you sure you want to logout? You will be redirected to the home page."
    confirmText="Yes, Logout"
    cancelText="Cancel"
    (confirm)="confirmLogout()"
    (cancel)="cancelLogout()">
  </app-confirmation-dialog>
</div> 