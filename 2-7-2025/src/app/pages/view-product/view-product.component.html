<nav class="navbar">
  <button class="btn back" (click)="goBack()">←</button>
  <div class="logo">
    <a href="home.component.html" style="text-decoration: none; color: #fff">
      Grocery<span>Mart</span>
    </a>
  </div>

  <app-search-bar
    (searchResults)="onSearchResults($event)"
    (searchError)="onSearchError($event)"
    (searchLoading)="onSearchLoading($event)"
    (clearSearch)="onClearSearch()"
  >
  </app-search-bar>

  <div class="links">
    <a routerLink="/user-dashboard/profile">Profile</a>
    <a (click)="showLogoutConfirm = true" style="cursor: pointer">Logout</a>
  </div>
</nav>

<div class="table-container">
  <!-- Search Error Message -->
  <div *ngIf="searchError" class="error-message">
    {{ searchError }}
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isSearching" class="loading-message">Searching products...</div>

  <!-- No Results Message -->
  <div *ngIf="showNoResults" class="no-results-message">
    No products found matching your search.
  </div>

  <table>
    <thead>
      <tr>
        <th>S.No</th>
        <th>Product_ID</th>
        <th>Product_Name</th>
        <th>Description</th>
        <th>Quantity</th>
        <th>Price</th>
        <!-- <th>Reserved</th> -->
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of displayed; let i = index">
        <td>{{ (page - 1) * perPage + i + 1 }}</td>
        <td>{{ product.productId }}</td>
        <td>{{ product.productName }}</td>
        <td>{{ product.productDescription }}</td>
        <td>{{ product.quantity }}</td>
        <td>₹{{ product.price }}</td>
        <!-- <td>{{ product.reserved }}</td> -->
        <td>
          <button class="btn update" (click)="update(product.productId)">
            Update
          </button>
          <button class="btn delete" (click)="delete(product.productId)">
            Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="pagination">
    <button (click)="prev()" [disabled]="page === 1">Prev</button>
    <span>Page {{ page }}</span>
    <button
      (click)="next()"
      [disabled]="page * perPage >= filteredProducts.length"
    >
      Next
    </button>
  </div>
</div>

<!-- Confirmation Dialog -->
<div class="modal-backdrop" *ngIf="showConfirm">
  <div class="modal">
    <p>Are you sure you want to delete this product?</p>
    <button class="btn update" (click)="confirmDelete()">Yes</button>
    <button class="btn delete" (click)="cancelDelete()">No</button>
  </div>
</div>

<!-- Deleted-Success Dialog -->
<div class="modal-backdrop" *ngIf="showDeletedDialog">
  <div class="modal">
    <p>Product deleted successfully!</p>
    <button class="btn update" (click)="closeDeletedDialog()">OK</button>
  </div>
</div>

<!-- Error Dialog for Delete Failure -->
<div class="modal-backdrop" *ngIf="showErrorDialog">
  <div class="modal">
    <p>{{ errorMessage }}</p>
    <button class="btn update" (click)="closeErrorDialog()">OK</button>
  </div>
</div>


